# 見積書を育てる方針

曲げ加工まわりで、**計算書 → 実績反映 → 見積書（書類）** まで一気通貫で使えるようにするための進め方。

---

## 最終ゴール（目指す形）

**「見た目を良くした Excel または Google スプレッドシートに、自分で入力して結果を出力できる形態」** にする。

- **入力**: 形状・板厚・寸法・数量・穴数などを、シートの入力欄に打ち込むだけ。
- **出力**: 単価・合計（税抜・税込）や、必要なら見積書の1枚が自動で出る。
- **見た目**: 入力欄と結果が分かりやすいレイアウト、フォント・罫線・色で読みやすくする。そのまま印刷や PDF で提出できる体裁にする。

Claude Code や Cursor のチャットは「計算の確認用」や「データの更新用」として補助的に使い、**普段の見積もりは Excel/スプレッドシートだけで完結する**形が目標。

---

## いまあるもの

| もの | 状態 |
|:---|:---|
| 曲げ単価の計算ロジック | 基準価格テーブル × 形状乗率 × 数量調整。スキル＋計算書で計算可能 |
| 曲げ計算書（Excel） | 「見積り」「データ」の2シート。B3〜B8入力で単価・合計が出る |
| 実績データ | ハット曲げ PL6 展開396 L70 穴4-15φ 2個 → **@1,380円**（NO_527065）など |

**穴あけ単価**: `data/hole_prices.json` に登録済み（板厚別・丸穴/長穴・標準/下限）。計算書に組み込むときはこの表を参照する。

**まだないもの**: 見積書の「1枚の書類」フォーマット、実績の定期反映の仕組み。

---

## ステップ1: 穴あけを「ルール化」する（短期）

- **やること**: 穴あけを「曲げのあとの加算」として固定する。
- **穴あけ単価表**: 板厚別の **丸穴（標準/下限）・長穴（標準/下限）** を `data/hole_prices.json` に登録済み。径は表に含めず板厚のみなので、15φ など径は「標準」を使う想定（下限は最小ロット用など）。
- **計算書への入れ方**: 「データ」シートに `hole_prices.json` の内容をブロックで追加し、板厚・丸穴数・長穴数を入力すると穴あけ加算額が出るようにする（次のステップでExcelを拡張）。

**成果**: 曲げ＋穴あけまで、計算書だけで再現できる。

---

## ステップ2: 実績を「データ」に反映する（短期）

- **やること**: 決まった単価の案件を、基準価格テーブルや乗率の「校正」に使う。
- **やり方**:
  - 実績（例: 1,380円/個）と計算書の曲げのみ（1,350円）の差を「穴あけ分」としてメモする。
  - 同じ形状・寸法帯がまた来たら、**prices.json や Excel の「データ」シート**を実績に合わせて微調整する。
- **蓄積**: 「実績メモ」を1か所にまとめる（例: このフォルダに `実績メモ.md` を作り、案件番号・条件・単価・メモを追記していく）。

**成果**: 計算書の数字が現場の単価に近づく。

---

## ステップ3: 「1枚の見積書」フォーマットをつくる（中期）

- **やること**: お客様に出す「見積書」のレイアウトを1つ決める。
- **内容**:
  - ヘッダー（会社名・件名・日付・宛先）
  - 明細: 品名・仕様（板厚・形状・寸法・穴）・数量・単価・金額
  - 合計（税抜・税込）、有効期限や納期の注意書きなど
- **形式**: Excel か Google スプレッドシートで「見積書」シートを1枚用意し、計算書の合計や単価を**参照またはコピー**で流し込む。必要なら PDF で書き出して印刷・メール送付。

**成果**: 計算書で出した数字を、そのまま見積書として提出できる。

---

## ステップ4: 鉄骨の「3階建て」との関係を整理する（中期）

- CLAUDE.md の「3階建て」（材料費 → 調整係数 → 加算）は**鉄骨の本体**の見積もり。
- 曲げ加工・穴あけは**加工賃**なので、**加算項目の一部**として扱うか、**別枠の明細**にするかを社内で決める。
- 決まったら、「曲げ＋穴あけ」の合計を「3階の加算」に足す、または見積書の別行で「曲げ加工費」として記載する、などのルールを1行で書いておく。

**成果**: 鉄骨の見積もりと曲げ・穴あけの計算が矛盾しない。

---

## ステップ5: 運用ルールを短く決める（中期）

- **誰が**計算書を触るか（社長だけか、現場もか）。
- **いつ**実績を反映するか（月1回まとめて、など）。
- **見積書のバージョン**をどう管理するか（日付入りファイル名、など）。

ここまでを **計算書の使い方.md** やこのファイルに追記しておくと、あとから引き継ぎしやすい。

---

## まとめ：優先順位

| 順番 | やること | 目的 |
|:---:|:---|:---|
| 1 | 穴あけの単価ルールを決め、計算書に加算を足す | 曲げ＋穴まで計算書で出せる |
| 2 | 実績（NO_527065 など）をメモし、テーブルを微調整 | 計算が実務に合う |
| 3 | 見積書の1枚フォーマット（Excel/PDF）を作る | そのまま提出できる |
| 4 | 3階建てとの役割分担を決める | 鉄骨本体と加工賃の整合 |
| 5 | 運用ルールを書いておく | 継続しやすい |

まずは **ステップ1（穴あけのルール化）** と **ステップ2（実績メモ＋テーブル微調整）** から始めると、見積書の「中身」がしっかりしてきます。

---

## ゴールに向けた「見た目・入力→出力」の整理

最終形の Excel/スプレッドシートで揃えたい点。

| 項目 | 内容 |
|:---|:---|
| **入力エリア** | 形状・板厚・展開幅・長さ・材質・数量・丸穴数・長穴数を、一目で分かるセルにまとめる。ドロップダウンで選べる項目はリスト化。 |
| **計算結果の表示** | 曲げ単価・穴あけ加算・合計（税抜）・税額・合計（税込）を、入力エリアの近くに大きく表示。 |
| **見た目** | タイトル・見出しを太字や背景色で区切る。罫線で入力欄とデータ欄を分ける。フォントサイズは読みやすい大きさに。 |
| **見積書シート（任意）** | 1枚で印刷できる「見積書」レイアウト。会社名・宛先・日付・明細・合計を並べ、計算シートの合計を参照で流し込む。 |
| **データシート** | 基準価格・形状乗率・穴あけ単価は「データ」シートに置き、編集しやすくする。表の体裁を整える。 |

これらを `build_calc_sheet.py` の拡張や、手動で Excel を整える作業で少しずつ満たしていく。
