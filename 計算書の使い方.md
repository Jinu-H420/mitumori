# 曲げ加工見積り 計算書の使い方

## 1. 計算書を用意する（まだない場合）

ターミナルで次を実行すると、このフォルダに **曲げ加工見積り_計算書.xlsx** が作られます。

```bash
cd .claude/skills/bending-estimate
python3 -m pip install openpyxl   # 初回だけ
python3 build_calc_sheet.py
```

## 2. ファイルを開く

- **推奨**: **Google スプレッドシート**で開く（下の手順でアップロード→「Google スプレッドシートで開く」を指定）。
- Excel や Numbers で開くと、別シート「データ」への参照が壊れて単価・合計が 0 になることがあります。**うまく動かないときは、自分で「Google スプレッドシートで開く」を指定してください。**

---

## Google スプレッドシートで開く方法（具体的な手順）

### 準備：開きたいファイルがどこにあるか

- ファイル名: **曲げ加工見積り_計算書.xlsx**
- 場所（Mac）: **iCloud ドライブ** → **md~obsidian** → **Documents** → **BRAIN2** → **.claude** → **skills** → **bending-estimate** のなか。
- Cursor でこのプロジェクトを開いている場合: 左のファイル一覧で **.claude** → **skills** → **bending-estimate** を開くと **曲げ加工見積り_計算書.xlsx** がある。

---

### ステップ1: Google ドライブを開く

1. **ブラウザ**（Chrome や Safari）を開く。
2. アドレス欄に **drive.google.com** と入力して Enter。
3. **Google アカウントでログイン**する（まだログインしていない場合）。

---

### ステップ2: 計算書ファイルをアップロードする

1. 画面左上の **「新規」** ボタンをクリック。
2. メニューから **「ファイルのアップロード」** を選ぶ。
3. 開いたウィンドウで、上で確認したフォルダ（**BRAIN2 → .claude → skills → bending-estimate**）まで移動する。
4. **曲げ加工見積り_計算書.xlsx** をクリックして選び、**「開く」** をクリック。
5. アップロードが終わると、ドライブの一覧に **曲げ加工見積り_計算書** というファイルが表示される。

---

### ステップ3: 「Google スプレッドシートで開く」を指定する

1. ドライブの一覧で **曲げ加工見積り_計算書** のファイルを **右クリック**。
2. 出てきたメニューの **「アプリで開く」** にマウスを乗せる。
3. さらに **「Google スプレッドシート」** をクリック。

→ 新しいタブで **Google スプレッドシート** が開き、計算書の内容が表示される。

**別のやり方（ダブルクリックした場合）:**  
ファイルをダブルクリックするとプレビューが開くことがある。その画面の **右上あたり** に **「Google スプレッドシートで開く」** というボタンやリンクがあれば、それをクリックしても同じように開ける。

---

### ステップ4: 計算書を使う

1. 下の方に **「見積り」「データ」** といったシート名のタブがある。**「見積り」** をクリックする（最初から見積りが開いている場合もある）。
2. **B3〜B10** のセルに、形状・板厚・展開幅・長さ・材質・数量・丸穴数・長穴数を入力する。
3. 入力が終わると、下の **B17（単価）・B19（合計税抜）・B21（合計税込）** に自動で金額が出る。

**注意**: 形状・材質は一覧から選べないときは、B3 に「L曲げ」「コの字曲げ」、B7 に「SS400」などを直接入力する（表記は SKILL の一覧と揃える）。

## 3. 見積りシートの入力

| セル | 入力内容 | 例 |
|:---|:---|:---|
| **B3** | 形状 | ドロップダウンから選択（L曲げ／コの字曲げ／ハット曲げ など） |
| **B4** | 板厚(mm) | 1.6 |
| **B5** | 展開幅(mm) | 570 |
| **B6** | 製品長さ(mm) | 40 |
| **B7** | 材質 | SS400 または SUS304 |
| **B8** | 数量 | 1 |
| **B9** | 丸穴数(個) | 0（穴なしのときは0） |
| **B10** | 長穴数(個) | 0（穴なしのときは0） |

## 4. 結果を見る

- **B12〜B21** に自動で計算結果が出ます。  
  比重 → 重量 → 基準価格 → 形状乗率 → 数量調整 → **単価(税抜)** → **穴あけ加算** → **合計(税抜)** → 消費税 → **合計(税込)**。
- 単価・合計は **B17（単価）・B19（合計税抜）・B21（合計税込）** を確認すればOKです。

## 5. データを変えたいとき

- **データ** シートで基準価格や形状乗率を編集すると、見積り結果も連動して変わります。
- `data/prices.json` や `data/rates.json` を編集したあと、もう一度 `python3 build_calc_sheet.py` を実行すると、その内容で計算書をやり直せます。

## 6. 穴あけ単価について

- 穴あけの単価（板厚別・丸穴/長穴・標準/下限）は **`data/hole_prices.json`** に登録されています。
- 計算書の **B9（丸穴数）・B10（長穴数）** に入力すると、板厚に応じた単価で **穴あけ加算** が自動計算され、**合計(税抜)** に含まれます。「データ」シートに穴あけ単価表（E10:J22）があります。
